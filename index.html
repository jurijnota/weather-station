<!DOCTYPE html>
<html>
  <head>
    <title>Weather Station</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script><html>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.27.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@0.1.1"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  </head>
  <body>
    <div>
      <canvas id="tempChart"></canvas>
    </div>
    <div>
      <canvas id="presChart"></canvas>
    </div>
    <div>
      <canvas id="humChart"></canvas>
    </div>
  </body>
</html>

<script>
  var api = {
    url: null,
    call: function (data) {
      var options = {
          type: "POST",
          contentType: "application/json",
          dataType: "json",
          url: 'api.php',
          data: JSON.stringify(data)
      };

      return $.ajax(options);
    }
  };

  var firstDate = new Date();
  firstDate.setDate(firstDate.getDate() - 1);

  api.call({
    valid: true,
    firstDate: firstDate
  }).done(function (data) {
    var temp_config = {
      type: 'line',
      data: {
        labels: data.labels,
        datasets: [{
          label: 'Temperature (C)',
          backgroundColor: 'rgb(52, 86, 139)',
          borderColor: 'rgb(52, 86, 139)',
          data: data.temp_data,
        }]
      },
      options: {
        scales: {
          x: {
              type: 'time',
              time: {
                  unit: 'minute'
              }
          }
        },
        plugins: {
          legend: {
            display: false
          }
        }
      }
    };

    var pres_config = {
      type: 'line',
      data: {
        labels: data.labels,
        datasets: [{
          label: 'Pressure (hPa)',
          backgroundColor: 'rgb(255, 111, 97)',
          borderColor: 'rgb(255, 111, 97)',
          data: data.pres_data,
        }]
      },
      options: {
        scales: {
          x: {
              type: 'time',
              time: {
                  unit: 'minute'
              }
          }
        },
        plugins: {
          legend: {
            display: false
          }
        }
      }
    };

    var hum_config = {
      type: 'line',
      data: {
        labels: data.labels,
        datasets: [{
          label: 'Humidity (%)',
          backgroundColor: 'rgb(136, 176, 75)',
          borderColor: 'rgb(136, 176, 75)',
          data: data.hum_data,
        }]
      },
      options: {
        scales: {
          x: {
            type: 'time',
            time: {
                unit: 'minute'
            }
          },
          y: {
            min: 0,
            max: 100
          }
        },
        plugins: {
          legend: {
            display: false
          }
        }
      }
    };

    var tempChart = new Chart(
      document.getElementById('tempChart'),
      temp_config
    );

    var presChart = new Chart(
      document.getElementById('presChart'),
      pres_config
    );

    var humChart = new Chart(
      document.getElementById('humChart'),
      hum_config
    );
  });
</script>